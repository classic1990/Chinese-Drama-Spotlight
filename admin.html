<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard | DUYDODEE-HD</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé¨</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
<style>
    body { margin: 0; font-family: 'Prompt', sans-serif; background: #1a1a1a; color: #fff; padding: 30px; }
    .container { max-width: 1200px; margin: 0 auto; }
    .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #444; padding-bottom: 20px; }
    .header h1 { margin: 0; }
    .form-card { background: #2b2b2b; padding: 30px; border-radius: 18px; margin-top: 30px; }
    .form-card h2 { margin-top: 0; }
    .input-group { margin-bottom: 15px; }
    .input-group label { display: block; margin-bottom: 8px; }
    .input-group input, .input-group textarea, .input-group select { box-sizing: border-box; width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #555; background: #333; color: #fff; font-size: 16px; font-family: 'Prompt', sans-serif; }
    .input-group .note { font-size: 12px; color: #aaa; margin-top: 5px; }
    .btn { padding: 12px 25px; border-radius: 8px; border: none; cursor: pointer; transition: background 0.3s ease; font-size: 16px; }
    .btn-primary { background: #e50914; color: #fff; }
    .btn-primary:hover { background: #ff1f2d; }
    .btn-danger { background: #8b0000; color: #fff; }
    .btn-danger:hover { background: #a52a2a; }
    .movie-list { margin-top: 30px; }
    .movie-item { display: flex; align-items: center; gap: 20px; background: #2b2b2b; padding: 15px; border-radius: 12px; margin-bottom: 15px; }
    .movie-item img { width: 80px; height: 120px; object-fit: cover; border-radius: 8px; flex-shrink: 0; }
    .movie-item-info { flex-grow: 1; }
    .movie-item-info h3 { margin: 0 0 5px 0; }
    .movie-item-info .category-badge { font-size: 12px; background: #555; color: #eee; padding: 3px 8px; border-radius: 5px; display: inline-block; }
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Admin Dashboard</h1>
        <button id="logoutBtn" class="btn btn-danger">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>

    <div class="form-card">
        <h2 id="formTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà</h2>
        <form id="movieForm">
            <div class="input-group">
                <label for="category">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                <select id="category" required>
                    <option value="movie">‡∏†‡∏≤‡∏û‡∏¢‡∏ô‡∏ï‡∏£‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</option>
                    <option value="series">‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡∏à‡∏µ‡∏ô‡∏û‡∏≤‡∏Å‡∏¢‡πå‡πÑ‡∏ó‡∏¢‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï</option>
                    <option value="vertical">‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡∏à‡∏µ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á</option>
                </select>
            </div>
            <div class="input-group">
                <label for="title">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                <input type="text" id="title" required placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏£‡∏±‡∏Å‡πÉ‡∏™‡πÜ ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á EP.1">
            </div>
            <div class="input-group">
                <label for="poster">URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÇ‡∏õ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á)</label>
                <input type="url" id="poster" required placeholder="https://...">
            </div>
            <div class="input-group">
                <label for="banner">URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå (‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô, ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á)</label>
                <input type="url" id="banner" placeholder="https://...">
            </div>
            <div class="input-group">
                <label for="desc">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡πà‡∏≠</label>
                <textarea id="desc" rows="4"></textarea>
            </div>
            <div class="input-group">
                <label for="videoUrl">URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏ä‡∏° / Embed Link</label>
                <input type="url" id="videoUrl" required placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå Embed ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô">
                <p class="note">üí° YouTube Embed: https://www.youtube.com/embed/‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏•‡∏¥‡∏õ</p>
            </div>
            <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </form>
    </div>

    <div class="movie-list">
        <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <div id="movieListContainer">
            <p style="color:#aaa;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyAcCn0NGbakHmLEa_G47K8OepGaRqTV02Q",
      authDomain: "duydodeesport.firebaseapp.com",
      projectId: "duydodeesport",
      storageBucket: "duydodeesport.appspot.com",
      messagingSenderId: "435929814225",
      appId: "1:435929814225:web:fcb01803d9e5b77340e1f0",
      measurementId: "G-JD1MFCNLY0"
    };
    
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
    auth.onAuthStateChanged(user => {
        if (!user) {
            // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login.html
            // window.location.href = 'login.html'; 
            
            // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå login.html ‡∏ú‡∏°‡∏Ç‡∏≠ Comment ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ö‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô
            // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á login ‡∏à‡∏£‡∏¥‡∏á
            console.log("User not logged in (Auto-redirect disabled for testing)");
        }
    });

    document.getElementById('logoutBtn').addEventListener('click', () => {
        auth.signOut().then(() => alert('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß'));
    });

    const movieForm = document.getElementById('movieForm');
    const movieListContainer = document.getElementById('movieListContainer');
    
    const categoryDisplay = {
        movie: '‡∏†‡∏≤‡∏û‡∏¢‡∏ô‡∏ï‡∏£‡πå',
        series: '‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡∏û‡∏≤‡∏Å‡∏¢‡πå‡πÑ‡∏ó‡∏¢',
        vertical: '‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á'
    };

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    movieForm.addEventListener('submit', e => {
        e.preventDefault();
        
        // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÉ‡∏ô Firestore ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤
        const data = {
            category: document.getElementById('category').value,
            title: document.getElementById('title').value,
            poster: document.getElementById('poster').value,
            banner: document.getElementById('banner').value,
            description: document.getElementById('desc').value, // ‡πÉ‡∏ä‡πâ description ‡∏ï‡∏≤‡∏° index.html
            videoUrl: document.getElementById('videoUrl').value, // ‡πÉ‡∏ä‡πâ videoUrl ‡∏ï‡∏≤‡∏° index.html
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        db.collection('movies').add(data).then(() => {
            alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            movieForm.reset();
        }).catch(err => {
            console.error('Error adding content: ', err);
            alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message);
        });
    });

    // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏ö‡∏ö Real-time
    db.collection('movies').orderBy('createdAt', 'desc').onSnapshot(snapshot => {
        movieListContainer.innerHTML = '';
        if(snapshot.empty) {
            movieListContainer.innerHTML = '<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>';
            return;
        }

        snapshot.forEach(doc => {
            const movie = doc.data();
            const categoryName = categoryDisplay[movie.category] || movie.category;
            
            const movieEl = document.createElement('div');
            movieEl.classList.add('movie-item');
            movieEl.innerHTML = `
                <img src="${movie.poster}" alt="${movie.title}" onerror="this.src='https://via.placeholder.com/80x120?text=No+Img'">
                <div class="movie-item-info">
                    <h3>${movie.title}</h3>
                    <span class="category-badge">${categoryName}</span>
                    <div style="font-size:12px; color:#aaa; margin-top:5px;">ID: ${doc.id}</div>
                </div>
                <button class="btn btn-danger" onclick="deleteMovie('${doc.id}')">‡∏•‡∏ö</button>
            `;
            movieListContainer.appendChild(movieEl);
        });
    }, error => {
        console.error("Error loading list:", error);
        movieListContainer.innerHTML = '<p style="color:red">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console)</p>';
    });

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏´‡∏ô‡∏±‡∏á
    window.deleteMovie = function(id) {
        if (confirm('‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ? \n‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
            db.collection('movies').doc(id).delete()
              .then(() => console.log('Content deleted!'))
              .catch(err => alert('Error deleting content: ' + err.message));
        }
    }
</script>

</body>
</html>
